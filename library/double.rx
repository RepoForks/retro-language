chain: double'
  : s>d     ( n-dd )  dup 0 < [ -1 ] [ 0 ] if ;
  : d+      ( dd-d )  [ rot over + [  > [ 1+ ] ifTrue  ] sip swap ] dip + ;
  : m+      ( nd-d )  s>d d+ ;
  : d2*     ( dd-d )  2over d+ ;
  : dnegate  [ not ] bi@ 1 0 d+ ;
  : dabs  dup 0 < [ dnegate ] ifTrue ;
;chain


